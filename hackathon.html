<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Banking APK Malware Detection System</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .card-shadow {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .pulse-animation {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .upload-area {
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            transform: translateY(-2px);
        }

        .chart-container {
            height: 300px;
        }

        .detailed-chart {
            height: 400px;
        }
    </style>
</head>

<body class="bg-gray-50 font-sans">
    <!-- Header -->
    <header class="gradient-bg text-white py-6 shadow-lg">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <i class="fas fa-shield-alt text-3xl"></i>
                    <div>
                        <h1 class="text-2xl font-bold">Banking APK Security Analyzer</h1>
                        <p class="text-sm opacity-90">Advanced AI-Powered Malware Detection System</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="text-right">
                        <div class="text-sm opacity-90">Detection Accuracy</div>
                        <div class="text-xl font-bold">99.1%</div>
                    </div>
                    <div class="text-right">
                        <div class="text-sm opacity-90">Scanned Today</div>
                        <div class="text-xl font-bold" id="scannedCount">0</div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Upload Section -->
        <section class="mb-8">
            <div class="bg-white rounded-lg shadow-lg p-8">
                <h2 class="text-2xl font-bold mb-6 text-gray-800">
                    <i class="fas fa-upload text-blue-600 mr-2"></i>
                    APK Analysis Center
                </h2>

                <div class="grid md:grid-cols-2 gap-6">
                    <!-- Single File Upload -->
                    <div class="upload-area bg-blue-50 border-2 border-dashed border-blue-300 rounded-lg p-8 text-center cursor-pointer"
                        id="singleUpload">
                        <i class="fas fa-file-upload text-4xl text-blue-500 mb-4"></i>
                        <h3 class="text-lg font-semibold mb-2">Single APK Analysis</h3>
                        <p class="text-gray-600 mb-4">Drag & drop an APK file or click to browse</p>
                        <input type="file" id="singleFileInput" accept=".apk" class="hidden">
                        <button class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">
                            Select APK File
                        </button>
                    </div>

                    <!-- Batch Upload -->
                    <div class="upload-area bg-green-50 border-2 border-dashed border-green-300 rounded-lg p-8 text-center cursor-pointer"
                        id="batchUpload">
                        <i class="fas fa-layer-group text-4xl text-green-500 mb-4"></i>
                        <h3 class="text-lg font-semibold mb-2">Batch Processing</h3>
                        <p class="text-gray-600 mb-4">Upload multiple APK files for analysis</p>
                        <input type="file" id="batchFileInput" accept=".apk" multiple class="hidden">
                        <button class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition">
                            Select Multiple APKs
                        </button>
                    </div>
                </div>

                <!-- Analysis Options -->
                <div class="mt-6 bg-gray-50 rounded-lg p-4">
                    <h4 class="font-semibold mb-3">Analysis Mode</h4>
                    <div class="flex space-x-4">
                        <label class="flex items-center">
                            <input type="radio" name="analysisMode" value="quick" checked class="mr-2">
                            <span>Quick Scan (0.07ms) - 93.97% accuracy</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="analysisMode" value="balanced" class="mr-2">
                            <span>Balanced (91ms) - 94.01% accuracy</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="analysisMode" value="deep" class="mr-2">
                            <span>Deep Analysis (3-5s) - 99.1% accuracy</span>
                        </label>
                    </div>
                </div>
            </div>
        </section>

        <!-- Progress Section -->
        <section id="progressSection" class="mb-8 hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-bold mb-4">
                    <i class="fas fa-cog fa-spin text-blue-600 mr-2"></i>
                    Analysis in Progress
                </h3>
                <div class="space-y-4">
                    <div class="bg-gray-200 rounded-full h-2">
                        <div id="overallProgress" class="bg-blue-600 h-2 rounded-full transition-all duration-300"
                            style="width: 0%"></div>
                    </div>
                    <div id="stagesList" class="space-y-2">
                        <!-- Progress stages will be populated here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Results Section -->
        <section id="resultsSection" class="mb-8 hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold text-gray-800">
                        <i class="fas fa-chart-line text-green-600 mr-2"></i>
                        Analysis Results
                    </h3>
                    <button id="exportBtn"
                        class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition">
                        <i class="fas fa-download mr-2"></i>Export Report
                    </button>
                </div>

                <!-- Summary Cards -->
                <div class="grid md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-gradient-to-r from-red-500 to-red-600 text-white p-6 rounded-lg">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-red-100 text-sm">Threat Level</p>
                                <p id="threatLevel" class="text-2xl font-bold">LOW</p>
                            </div>
                            <i class="fas fa-exclamation-triangle text-3xl text-red-200"></i>
                        </div>
                    </div>
                    <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-6 rounded-lg">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-blue-100 text-sm">Malware Probability</p>
                                <p id="malwareProbability" class="text-2xl font-bold">0%</p>
                            </div>
                            <i class="fas fa-percentage text-3xl text-blue-200"></i>
                        </div>
                    </div>
                    <div class="bg-gradient-to-r from-green-500 to-green-600 text-white p-6 rounded-lg">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-green-100 text-sm">Security Score</p>
                                <p id="securityScore" class="text-2xl font-bold">95/100</p>
                            </div>
                            <i class="fas fa-shield-alt text-3xl text-green-200"></i>
                        </div>
                    </div>
                    <div class="bg-gradient-to-r from-purple-500 to-purple-600 text-white p-6 rounded-lg">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-purple-100 text-sm">Analysis Time</p>
                                <p id="analysisTime" class="text-2xl font-bold">0ms</p>
                            </div>
                            <i class="fas fa-clock text-3xl text-purple-200"></i>
                        </div>
                    </div>
                </div>

                <!-- Charts Section -->
                <div class="grid md:grid-cols-2 gap-6 mb-8">
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h4 class="text-lg font-semibold mb-4">Model Confidence Scores</h4>
                        <div class="chart-container">
                            <canvas id="modelScoresChart"></canvas>
                        </div>
                    </div>
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h4 class="text-lg font-semibold mb-4">Security Analysis Breakdown</h4>
                        <div class="chart-container">
                            <canvas id="securityBreakdownChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Detailed Analysis -->
                <div class="bg-gray-50 p-6 rounded-lg mb-6">
                    <h4 class="text-lg font-semibold mb-4">Detailed Security Analysis</h4>
                    <div class="detailed-chart">
                        <canvas id="permissionAnalysisChart"></canvas>
                    </div>
                </div>

                <!-- Findings -->
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-red-50 border border-red-200 p-6 rounded-lg">
                        <h4 class="text-lg font-semibold text-red-800 mb-3">
                            <i class="fas fa-exclamation-triangle mr-2"></i>Security Issues
                        </h4>
                        <ul id="securityIssues" class="space-y-2 text-red-700">
                            <!-- Issues will be populated here -->
                        </ul>
                    </div>
                    <div class="bg-green-50 border border-green-200 p-6 rounded-lg">
                        <h4 class="text-lg font-semibold text-green-800 mb-3">
                            <i class="fas fa-check-circle mr-2"></i>Security Features
                        </h4>
                        <ul id="securityFeatures" class="space-y-2 text-green-700">
                            <!-- Features will be populated here -->
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Historical Scans -->
        <section class="mb-8">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-bold mb-4">
                    <i class="fas fa-history text-gray-600 mr-2"></i>
                    Recent Scan History
                </h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-3 text-left">File Name</th>
                                <th class="px-4 py-3 text-left">Scan Time</th>
                                <th class="px-4 py-3 text-left">Threat Level</th>
                                <th class="px-4 py-3 text-left">Malware %</th>
                                <th class="px-4 py-3 text-left">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="historyTableBody" class="divide-y divide-gray-200">
                            <!-- History entries will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section class="mb-8">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-bold mb-4">
                    <i class="fas fa-info-circle text-blue-600 mr-2"></i>
                    Detection Technology
                </h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-semibold mb-3">Ensemble ML Models</h4>
                        <ul class="space-y-2 text-gray-600">
                            <li><i class="fas fa-check text-green-500 mr-2"></i>SVM Classifier (94.01% accuracy)</li>
                            <li><i class="fas fa-check text-green-500 mr-2"></i>CNN Bytecode Analysis (98.65% accuracy)
                            </li>
                            <li><i class="fas fa-check text-green-500 mr-2"></i>GRU Sequence Analysis (98.2% accuracy)
                            </li>
                            <li><i class="fas fa-check text-green-500 mr-2"></i>Logistic Regression (93.97% accuracy)
                            </li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-semibold mb-3">Security Analysis Features</h4>
                        <ul class="space-y-2 text-gray-600">
                            <li><i class="fas fa-check text-green-500 mr-2"></i>Permission-based Analysis (112 optimized
                                features)</li>
                            <li><i class="fas fa-check text-green-500 mr-2"></i>Certificate Validation</li>
                            <li><i class="fas fa-check text-green-500 mr-2"></i>Banking Trojan Detection</li>
                            <li><i class="fas fa-check text-green-500 mr-2"></i>Behavioral Pattern Recognition</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        // Global state
        let scanHistory = [];
        let currentAnalysis = null;
        let charts = {};

        // Banking permissions and dangerous patterns
        const dangerousPermissions = [
            'SEND_SMS', 'RECEIVE_SMS', 'READ_SMS', 'CALL_PHONE', 'READ_CALL_LOG',
            'WRITE_CALL_LOG', 'SYSTEM_ALERT_WINDOW', 'WRITE_SETTINGS', 'CAMERA',
            'RECORD_AUDIO', 'READ_CONTACTS', 'WRITE_CONTACTS', 'ACCESS_FINE_LOCATION',
            'DEVICE_ADMIN', 'BIND_ACCESSIBILITY_SERVICE'
        ];

        const bankingTrojanSignatures = [
            'overlay', 'banking', 'keylogger', 'remote', 'admin', 'accessibility',
            'fake', 'trojan', 'stealer', 'phishing', 'credential'
        ];

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function () {
            setupEventListeners();
            loadScanHistory();
            updateScannedCount();
        });

        function setupEventListeners() {
            // Single file upload
            const singleUpload = document.getElementById('singleUpload');
            const singleFileInput = document.getElementById('singleFileInput');

            singleUpload.addEventListener('click', () => singleFileInput.click());
            singleFileInput.addEventListener('change', handleSingleFileUpload);

            // Batch file upload
            const batchUpload = document.getElementById('batchUpload');
            const batchFileInput = document.getElementById('batchFileInput');

            batchUpload.addEventListener('click', () => batchFileInput.click());
            batchFileInput.addEventListener('change', handleBatchFileUpload);

            // Drag and drop
            setupDragAndDrop(singleUpload, handleSingleFileUpload);
            setupDragAndDrop(batchUpload, handleBatchFileUpload);

            // Export button
            document.getElementById('exportBtn').addEventListener('click', exportReport);
        }

        function setupDragAndDrop(element, handler) {
            element.addEventListener('dragover', (e) => {
                e.preventDefault();
                element.classList.add('border-blue-500', 'bg-blue-100');
            });

            element.addEventListener('dragleave', () => {
                element.classList.remove('border-blue-500', 'bg-blue-100');
            });

            element.addEventListener('drop', (e) => {
                e.preventDefault();
                element.classList.remove('border-blue-500', 'bg-blue-100');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handler({ target: { files } });
                }
            });
        }

        function handleSingleFileUpload(event) {
            const file = event.target.files[0];
            if (file && file.name.endsWith('.apk')) {
                analyzeAPK(file);
            } else {
                alert('Please select a valid APK file.');
            }
        }

        function handleBatchFileUpload(event) {
            const files = Array.from(event.target.files);
            const apkFiles = files.filter(file => file.name.endsWith('.apk'));

            if (apkFiles.length > 0) {
                processBatchAnalysis(apkFiles);
            } else {
                alert('Please select valid APK files.');
            }
        }

        async function analyzeAPK(file) {
            currentAnalysis = {
                fileName: file.name,
                fileSize: file.size,
                startTime: Date.now(),
                analysisMode: document.querySelector('input[name="analysisMode"]:checked').value
            };

            showProgressSection();
            hideResultsSection();

            try {
                // Simulate APK analysis
                const analysisResult = await performAnalysis(file);
                showResults(analysisResult);
                addToHistory(analysisResult);
                updateScannedCount();
            } catch (error) {
                console.error('Analysis failed:', error);
                alert('Analysis failed. Please try again.');
            } finally {
                hideProgressSection();
            }
        }

        async function performAnalysis(file) {
            const stages = [
                { name: 'Extracting APK Structure', duration: 500 },
                { name: 'Permission Analysis', duration: 800 },
                { name: 'Certificate Validation', duration: 600 },
                { name: 'Bytecode Pattern Recognition', duration: 1200 },
                { name: 'Banking Trojan Detection', duration: 900 },
                { name: 'Behavioral Analysis', duration: 1000 },
                { name: 'Ensemble Model Prediction', duration: 700 }
            ];

            const stagesList = document.getElementById('stagesList');
            const overallProgress = document.getElementById('overallProg    ress');

            stagesList.i
        };
    </script>
</body>

</html>